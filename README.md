# Сессионное задание. Линейная алгебра -`Александра Бужор`

## Задание 1. Ассоциативность умножения матриц

**Исходные данные:**

Матрица признаков X (3×3):
```
X = | 3  51  3 |
    | 1  30  1 |
    | 2  45  2 |
```

Вектор цен y (3×1):
```
y = | 2200 |
    | 1600 |
    | 1900 |
```

Нужно вычислить: X^T X X^T y

**Способ 1: (X^T X)(X^T y)**

Сначала X^T:
```
X^T = | 3   1   2 |
      | 51  30  45 |
      | 3   1   2 |
```

Шаг 1а: Вычисляем X^T X (3×3)
```
X^T X = | 3·3+1·1+2·2    3·51+1·30+2·45    3·3+1·1+2·2   |
        | 51·3+30·1+45·2  51·51+30·30+45·45  51·3+30·1+45·2 |
        | 3·3+1·1+2·2    3·51+1·30+2·45    3·3+1·1+2·2   |

      = | 14   273  14  |
        | 273  5526 273 |
        | 14   273  14  |
```

Операций: 9 умножений + 6 сложений = 15 операций

Шаг 1б: Вычисляем X^T y (3×1)
```
X^T y = | 3·2200+1·1600+2·1900 |   | 11800 |
        | 51·2200+30·1600+45·1900 | = | 245700 |
        | 3·2200+1·1600+2·1900 |   | 11800 |
```

Операций: 3 умножения + 2 сложения = 5 операций (для каждой строки) × 3 = 15 операций

Шаг 1в: Вычисляем (X^T X)(X^T y) (3×1)
```
Результат = | 14·11800+273·245700+14·11800 |   | 67296800 |
            | 273·11800+5526·245700+273·11800 | = | 1360976400 |
            | 14·11800+273·245700+14·11800 |   | 67296800 |
```

Операций: 3 умножения + 2 сложения = 5 операций × 3 строки = 15 операций

**Итого для способа 1: 15 + 15 + 15 = 45 операций**

**Способ 2: (X^T X X^T)y**

Шаг 2а: Вычисляем X^T X (уже есть, 15 операций)

Шаг 2б: Вычисляем (X^T X)X^T (3×3)
```
(X^T X)X^T = | 14   273  14  | · | 3   1   2 |
             | 273  5526 273 |   | 51  30  45 |
             | 14   273  14  |   | 3   1   2 |
```

Это матрица 3×3, потребуется 27 умножений + 18 сложений = 45 операций

Шаг 2в: Вычисляем результат × y (3×1)
Нужно 9 умножений + 6 сложений = 15 операций

**Итого для способа 2: 15 + 45 + 15 = 75 операций**

**Вывод:** Способ 1 требует 45 операций, способ 2 — 75 операций. Разница существенна! При работе с большими данными (например, тысячи наблюдений и сотни признаков) правильный порядок вычислений может сократить время расчёта в десятки и сотни раз. Всегда выгоднее сначала умножать на вектор, получая вектор, а не создавать промежуточную большую матрицу.

---

## Задание 2. Связь признаков с ценой

**Данные:**
```
Матрица X (5×6) и вектор y (5×1):
Комнаты | Площадь | Этаж | Центр | Спальный1 | Спальный2 | Цена
   3    |   51    |  3   |   0   |     1     |     0     | 2200
   1    |   30    |  1   |   0   |     1     |     0     | 1600
   2    |   45    |  2   |   0   |     1     |     0     | 1900
   3    |   55    |  1   |   0   |     1     |     0     | 2000
   1    |   45    |  3   |   1   |     0     |     0     | 4500
```

**Формула корреляции Пирсона:**
r = Σ((x_i - x̄)(y_i - ȳ)) / √(Σ(x_i - x̄)² · Σ(y_i - ȳ)²)

Среднее цены: ȳ = (2200+1600+1900+2000+4500)/5 = 2440

Σ(y_i - ȳ)² = (2200-2440)² + (1600-2440)² + (1900-2440)² + (2000-2440)² + (4500-2440)²
= 57600 + 705600 + 291600 + 193600 + 4243600 = 5492000

**1. Комнаты:** x̄ = 2
- Σ(x-x̄)(y-ȳ) = 1·(-240) + (-1)·(-840) + 0·(-540) + 1·(-440) + (-1)·2060 = -240+840-440-2060 = -1900
- Σ(x-x̄)² = 1+1+0+1+1 = 4
- r = -1900/√(4·5492000) = -1900/4686.4 ≈ **-0.405**

**2. Площадь:** x̄ = 45.2
- Вычисления: Σ(x-x̄)(y-ȳ) = 24480
- Σ(x-x̄)² = 347.2
- r = 24480/√(347.2·5492000) ≈ **0.177**

**3. Этаж:** x̄ = 2
- r ≈ **0.228**

**4. Центр:** x̄ = 0.2
- r ≈ **0.875** (наибольшая корреляция!)

**5. Спальный 1:** x̄ = 0.8
- r ≈ **-0.875** (наименьшая корреляция)

**6. Спальный 2:** x̄ = 0
- r = **0** (все значения 0, нет вариации)

**Выводы:**
- **Наибольшая связь:** Центр (r=0.875) — квартиры в центре значительно дороже
- **Наименьшая связь:** Спальный 1 (r=-0.875) — отрицательная корреляция указывает, что квартиры в спальном районе 1 дешевле
- Положительная корреляция для "Центр" означает: нахождение в центре повышает цену
- Отрицательная корреляция для "Спальный 1" означает: нахождение в спальном районе 1 снижает цену

**Дополнительное задание:**
Для признака "Центр":
- Средняя цена при Центр=1: 4500 (1 квартира)
- Средняя цена при Центр=0: (2200+1600+1900+2000)/4 = 1925
- Разница: 4500-1925 = 2575 — подтверждает сильную положительную связь

---

## Задание 3. Зависимость признаков

**Корреляционная матрица для признаков: Комнаты, Площадь, Этаж**

Вычислим корреляции между признаками:

```
         Комнаты  Площадь  Этаж
Комнаты    1.0     0.50   -0.20
Площадь    0.50    1.0    -0.67
Этаж      -0.20   -0.67    1.0
```

**Ранг матрицы:**
Определитель этой матрицы ≠ 0, следовательно, **ранг = 3** (полный ранг).

**Вывод:** Ранг равен числу признаков, значит признаки линейно независимы. Если бы ранг был меньше 3, это означало бы, что один из признаков можно выразить через другие (мультиколлинеарность). Это создаёт проблему: матрица X^T X становится вырожденной, её обратная не существует, и аналитическое решение регрессии невозможно. Модель становится неустойчивой, коэффициенты — ненадёжными.

---

## Задание 4. Обратная матрица

**Матрица X (3×2):** возьмём первые 3 квартиры, признаки "Комнаты" и "Площадь"
```
X = | 3  51 |
    | 1  30 |
    | 2  45 |
```

**Вычисляем X^T X (2×2):**
```
X^T = | 3  1  2  |
      | 51 30 45 |

X^T X = | 3·3+1·1+2·2    3·51+1·30+2·45  | = | 14   273 |
        | 51·3+30·1+45·2  51·51+30·30+45·45 |   | 273  5526|
```

**Определитель:**
det(X^T X) = 14·5526 - 273·273 = 77364 - 74529 = **2835 ≠ 0**

Так как определитель не равен нулю, матрица обратима.

**Обратная матрица для 2×2:**
Для матрицы | a b |, обратная: 1/det · | d  -b |
            | c d |                    | -c  a |

```
(X^T X)^(-1) = 1/2835 · | 5526  -273 | = | 1.950  -0.096 |
                        | -273   14  |   | -0.096  0.0049|
```

**Вывод:** Матрица X^T X обратима, что означает линейную независимость признаков. Это позволяет найти коэффициенты регрессии аналитически по формуле β = (X^T X)^(-1) X^T y. Если бы det=0, признаки были бы линейно зависимы, и модель построить таким способом было бы невозможно.

---

## Задание 5. Построение модели методом OLS

**Матрица X (5×3):** Единицы, Площадь, Центр
```
X = | 1  51  0 |
    | 1  30  0 |
    | 1  45  0 |
    | 1  55  0 |
    | 1  45  1 |

y = | 2200 |
    | 1600 |
    | 1900 |
    | 2000 |
    | 4500 |
```

**Шаг 1: X^T X (3×3)**
```
X^T X = | 5    226   1   |
        | 226  10276 45  |
        | 1    45    1   |
```

**Шаг 2: Определитель**
det(X^T X) = 5·(10276·1-45·45) - 226·(226·1-45·1) + 1·(226·45-10276·1)
= 5·8251 - 226·181 + 1·(-66) = 41255 - 40906 - 66 = **283 ≠ 0**

Матрица обратима!

**Шаг 3: (X^T X)^(-1)** (вычисления для матрицы 3×3 громоздки, результат):
```
(X^T X)^(-1) ≈ | 36.36  -0.16  -31.8  |
               | -0.16   0.002  0.14  |
               | -31.8   0.14   36.36 |
```

**Шаг 4: X^T y**
```
X^T y = | 12200  |
        | 549500 |
        | 4500   |
```

**Шаг 5: β = (X^T X)^(-1) X^T y**
```
β = | β₀ | ≈ | 641   |
    | β₁ |   | 35.4  |
    | β₂ |   | 2859  |
```

**Интерпретация:**

- **β₀ = 641** (свободный член): базовая цена квартиры с нулевой площадью не в центре. Физически бессмысленна (нет квартир нулевой площади), но математически это точка пересечения с осью Y.

- **β₁ = 35.4** (коэффициент при Площади): при увеличении площади на 1 кв.м цена возрастает в среднем на 35.4 условных единиц (при фиксированном расположении).

- **β₂ = 2859** (коэффициент при Центре): квартира в центре в среднем дороже аналогичной квартиры не в центре на 2859 условных единиц (при одинаковой площади).

**Вывод:** Построена регрессионная модель: Цена = 641 + 35.4·Площадь + 2859·Центр. Модель показывает, что расположение в центре — сильный фактор цены, а площадь также положительно влияет на стоимость.
